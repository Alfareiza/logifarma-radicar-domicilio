{% extends "base/base.html" %}
{% load static %}

{% block title %}Foto de la fórmula{% endblock %}

{% block content %}

<section class="vista4">
     <form enctype="multipart/form-data" action="" method="post">
        {% csrf_token %}
        {{ wizard.management_form }}
        {% include "base/logo.html" %}

        <h1 class="vist4">¡Envia fotografía de la formula medica!</h1>
        <p class="vist4_1"> Recuerda, los medicamentos de la autorización deben coincidir con los de la formula</p>
        {% for field in form %}
            {{ field.error }}
        {% endfor %}
        {% if wizard.form.forms %}
            {{ wizard.form.management_form }}
        {% else %}

            <div class="container">
                <div class="conten_foto" style="object-fit: contain;">
                    <img id="file-preview" class="img_fot">
                </div>
                <div class="btn_archi" id="id_btn_archi">
<!--                    <label for="file" id="fotoFormulaMedica-src">Select an Image</label>-->
                    <input required type="file" name="fotoFormulaMedica-src" accept="image/*"
                       id="id_fotoFormulaMedica-src"
                           class="arch_btn" >
                </div>
            </div>
<!--                <script src="{% static 'js/capture.js' %}"></script>-->
<!--                <video autoplay loop muted playsinline id="video" class="video">Video stream not available.</video>-->
<!--                <canvas id="canvas" style="display: none;"></canvas>-->
<!--                <img class="img_fot" id="photo" alt="your image" style="display: none;">-->
               <!--<input type="hidden" name="contact_wizard-current_step" value="fotoFormulaMedica" id="id_contact_wizard-current_step">-->
               <!--<label for="id_fotoFormulaMedica-src">Foto:</label>-->

<!--                <div id='tomarfoto-btn' class="col" style="display: grid;">-->
<!--                    <button class="btn_f btn-primary" type="button" >Tomar Foto</button>-->
<!--                </div>-->

<!--                <div id='tomarotrafoto-btn' class="col" style="display: none;" onClick="myFunction()">-->
<!--                    <button class="btn1 btn-danger" type="button" >Tomar Otra Foto</button>-->
<!--                </div>-->

                <div id='continuar-btn' class="col" style="display: none;">
                    <input type="submit" class="btn2 btn-success" value="Continuar"/>
                </div>
        {% endif %}
    </form>
</section>
<script>
    const continuarbtn = document.getElementById("continuar-btn");
    const uploadButton = document.getElementById('id_fotoFormulaMedica-src');
    uploadButton.addEventListener('change', (e)=>{
    const currFiles = e.target.files
    if(currFiles.length > 0){
          let src = URL.createObjectURL(currFiles[0])
          let imagePreview = document.getElementById('file-preview')
          let oul = document.getElementById('id_btn_archi')
          imagePreview.src = src
          imagePreview.style.display = "block"

          continuarbtn.style.display = "block";
          oul.style.display = "none";
        }
    })
</script>
{% endblock %}